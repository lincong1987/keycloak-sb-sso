<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.topinfo.basic.platform.plugin.data.permission.core.mapper.TpDataPermissionDeptMapper">

    <insert id="addBatch"
            parameterType="com.topinfo.basic.platform.plugin.data.permission.core.bean.entity.TpDataPermissionDept">
        insert into tp_data_permission_dept (id, perm_id, dept_id, tenant_id)
        values
        <foreach collection="list" item="item" index="index" separator="," >
         (
           #{item.id}, #{item.permId}, #{item.deptId}, #{item.tenantId}
         )
        </foreach>
    </insert>

    <delete id="deleteById" parameterType="java.lang.String">
        delete
          from tp_data_permission_dept
         where perm_id = #{permId}
    </delete>

    <select id="getById" resultType="java.lang.String" parameterType="java.lang.String">
        SELECT
            tdpd.dept_id
        FROM tp_data_permission_dept tdpd
        where perm_id = #{permId}
    </select>
    <select id="listDeptNodes" resultType="com.topinfo.basic.platform.common.bean.TreeNode">
        select tdb.DEPT_ID id
              ,tdb.DEPT_ID value
              ,tdb.DEPT_FULL_NAME label
          from tp_dept_basicinfo tdb
        where tdb.ACTIVED = 1
          and tdb.DEPT_ID in
        <foreach collection="deptIds" item="id" index="index" open="(" close=")" separator=",">
            #{id}
        </foreach>
    </select>

</mapper>